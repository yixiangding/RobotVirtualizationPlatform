bplist00ÑXUTI-DataÓ_$com.apple.traditional-mac-plain-text_public.utf8-plain-text_public.utf16-plain-textO"cvar container, stats;var camera, scene, renderer, orbitControl, delta;var mouseX = 0, mouseY = 0;var windowHalfX = window.innerWidth / 2;var windowHalfY = window.innerHeight / 2;var tweenParameters = {};var jointValue;var jointNum = 0;var target = {};var big_arm = 157;var small_arm = 181;var center_offset = 60;var head_offset = 50;var lastX, lastY, lastZ;var loader = new THREE.ColladaLoader();//Ö»ÒªÄ£ÐÍ¼ÓÔØÍê³É£¬»Øµ÷º¯Êý¾Í»á±»µ÷ÓÃ// loader.load("models/testRobot.dae", function(collada) {loader.load("models/robot_n.dae", function(collada) {	dae = collada.scene;	dae.traverse( function ( child ) {		if ( child instanceof THREE.Mesh ) {			child.geometry.computeFaceNormals();			child.material.shading = THREE.FlatShading;		}	} );	dae.scale.x = dae.scale.y = dae.scale.z = 10.0;	dae.updateMatrix();	kinematics = collada.kinematics;	init();	animate();});function init() {	//container = document.createElement( 'div' );	container = document.getElementById('output');	document.body.appendChild( container );	camera = new THREE.PerspectiveCamera(45		, window.innerWidth / window.innerHeight		, 1, 2000);	camera.position.x = 2;	camera.position.y = 2;	camera.position.z = 10;	//camera.lookAt(new THREE.Vector3(10, -10, -10));	scene = new THREE.Scene();	var ambient = new THREE.AmbientLight( 0x444444 );	scene.add( ambient );	scene.add(dae);	var directionalLight = new THREE.DirectionalLight( 0xffeedd );	directionalLight.position.set( 0, 0, 1 ).normalize();	scene.add( directionalLight );	renderer = new THREE.WebGLRenderer();	//renderer.setClearColor(0xEEEEEE);	renderer.setPixelRatio( window.devicePixelRatio );	renderer.setSize(window.innerWidth * 2 / 3, window.innerHeight);	container.appendChild( renderer.domElement );	window.addEventListener( 'resize', onWindowResize, false );	orbitControl = new THREE.OrbitControls(camera		, renderer.domElement);	orbitControl.autoRotate = false;	// ×Ô¶¯Ðý×ªÊ±ÖÓÏà¹Ø 	// var clock = new THREE.Clock();	// var delta = clock.getDelta();	stats = new Stats();	container.appendChild(stats.dom);	setupTween();  }function animate() {	requestAnimationFrame( animate );		render();	stats.update();	TWEEN.update();}function render() {	// camera.position.x += ( mouseX - camera.position.x ) * .05;	// camera.position.y += ( - mouseY - camera.position.y ) * .05;	camera.lookAt( scene.position );	//orbitControl.update(delta);	renderer.render( scene, camera );}function setupTween() {	//var duration = getRandomInt( 1000, 5000 );	duration = 1000;	jointNum = 0;	lastX = 291;	lastY = 0;	lastZ = 157;	for ( var i = 0; i < kinematics.joints.length; i ++ ) {		var joint = kinematics.joints[ i ];		var old = tweenParameters[ i ];		// console.log(old);		var position = old ? old : joint.zeroPosition;		tweenParameters[ i ] = position;		// target[ i ] = getRandomInt( joint.limits.min		// 	, joint.limits.max );		target[i] = 0;		jointNum ++;	}	console.log(jointNum);	jointValue = new Array(jointNum);	// kinematicsTween = new TWEEN.Tween( 	// 	tweenParameters ).to( target, duration ).easing( 	// 	TWEEN.Easing.Quadratic.Out );	kinematicsTween = new TWEEN.Tween( 		tweenParameters ).to( target, duration ).easing( 		TWEEN.Easing.Linear.None );	kinematicsTween.onUpdate( function() {		for ( var i = 0; i < kinematics.joints.length; i ++ ) {			kinematics.setJointValue( i, this[ i ] );		}	} );	kinematicsTween.start();	//execute setupTween every duration	//setTimeout( setupTween, duration );	}function getRandomInt( min, max ) {	return Math.floor( Math.random() * ( max - min + 1 ) ) + min;}function onWindowResize() {	windowHalfX = window.innerWidth / 2;	windowHalfY = window.innerHeight / 2;	camera.aspect = window.innerWidth / window.innerHeight;	camera.updateProjectionMatrix();	renderer.setSize( window.innerWidth * 2 / 3, window.innerHeight );}function submit() {	jointValue = new Array(jointNum);	//joint1 & 4 & 5 & 9 : main joint	jointValue[0] = document.getElementById('j1').value;	//joint1, base	jointValue[1] = document.getElementById('j4').value;	//joint2	jointValue[2] = 0;	//joint3	jointValue[3] = document.getElementById('j4').value;	//joint4, big arm	jointValue[4] = document.getElementById('j5').value;	//joint5, small arm	jointValue[5] = document.getElementById('j5').value;	//joint6	jointValue[6] = document.getElementById('j4').value;	//joint7	jointValue[7] = 0;	//joint8	jointValue[8] = - jointValue[3] - jointValue[4];	//joint9, head	updateTween();}function plan() {	var toDeg = 360 / (2 * Math.PI);	var angle_base = jointValue[0];	var angle_big = jointValue[3];	var angle_small = jointValue[4];	//Õý½â¹ý³Ì¡£Ð´´íÁË£¬Ó¦¸ÃÓÃ»¡¶ÈÖÆ´úÈëÈý½Çº¯Êý¡£	// var x = (Math.sin(-angle_big) * big_arm - (1 - Math.cos(angle_small)) * small_arm) * Math.cos(angle_base) + center_offset + head_offset;	// var y = x * tan(angle_base);	// var z = Math.sin(angle_small) * small_arm - (1 - Math.cos(angle_big)) * big_arm;	var des_x = document.getElementById('dx').value;	var des_y = document.getElementById('dy').value;	var des_z = document.getElementById('dz').value;	var arm_xy = Math.sqrt(Math.pow(des_x, 2) + Math.pow(des_y, 2)) - center_offset - head_offset;	var arm_xyz = Math.sqrt(Math.pow(arm_xy, 2) + Math.pow(des_z, 2));	var delta_arms = Math.acos((Math.pow(small_arm, 2) + Math.pow(big_arm, 2) - Math.pow(arm_xyz, 2)) / (2 * small_arm * big_arm)); //´ó±ÛÐ¡±Û¼ä¼Ð½Ç£¬»¡¶ÈÖÆ	var delta_big_arm = Math.acos((Math.pow(arm_xyz, 2) + Math.pow(big_arm, 2) - Math.pow(small_arm, 2)) / (2 * arm_xyz * big_arm))			+ Math.acos((Math.pow(arm_xyz, 2) + Math.pow(arm_xy, 2) - Math.pow(des_z, 2)) / (2 * arm_xyz * arm_xy));	var delta_rotation = Math.atan(des_y / des_x);	//jointValue = new Array(jointNum);	//joint1 & 4 & 5 & 9 : main joint	jointValue[0] = delta_rotation * toDeg;	//joint1, base	jointValue[1] = delta_big_arm * toDeg - 90;	//joint2	jointValue[2] = 0;	//joint3	jointValue[3] = jointValue[1];	//joint4, big arm	//jointValue[4] = (delta_arms + delta_big_arm) * toDeg - 180;	//joint5, small arm	jointValue[4] = delta_arms * toDeg - 90;	//joint5, small arm	jointValue[5] = jointValue[4];	//joint6	jointValue[6] = jointValue[1];	//joint7	jointValue[7] = 0;	//joint8	jointValue[8] = - jointValue[3] - jointValue[4];	//joint9, head	updateTween();}function updateTween() {	duration = 200;	let times = 5;	for (var j = 0; j < times; j ++) {		for ( var i = 0; i < kinematics.joints.length; i ++ ) {			var joint = kinematics.joints[ i ];			var old = tweenParameters[ i ];			// console.log(old);			var position = old ? old : joint.zeroPosition;			tweenParameters[ i ] = position;			// target[ i ] = getRandomInt( joint.limits.min			// 	, joint.limits.max );			target[i] = jointValue[i] / times * (j + 1);			//console.log(target[i]);		}		// kinematicsTween = new TWEEN.Tween( 		// 	tweenParameters ).to( target, duration ).easing( 		// 	TWEEN.Easing.Quadratic.Out );		kinematicsTween = new TWEEN.Tween( 			tweenParameters ).to( target, duration ).easing( 			TWEEN.Easing.Linear.None );		kinematicsTween.onUpdate( function() {			for ( var i = 0; i < kinematics.joints.length; i ++ ) {				//½Ç¶ÈÖµ£¬·Ç»¡¶È				let base = this[0];				let barm = this[3];				let arms = this[4] + 90;				//let head = this[8];					let toRad = 2 * Math.PI / 360;				kinematics.setJointValue( i, this[ i ] );				let x = (small_arm * Math.cos(toRad * (arms - 90 +barm))					 - big_arm * Math.sin(toRad * barm) + head_offset + center_offset)					 * Math.cos(toRad * base);				let y = x * Math.tan(toRad * base);				let z = small_arm * Math.sin(toRad * (arms - 90 +barm))					 + big_arm * Math.cos(toRad * barm);				document.getElementById('sx').value = x;				document.getElementById('sy').value = y;				document.getElementById('sz').value = z;				document.getElementById('j1').value = base;				document.getElementById('j4').value = barm;				document.getElementById('j5').value = arms - 90;							let material = new THREE.LineBasicMaterial({color:0xFF0000});				let geometry = new THREE.Geometry();				geometry.vertices.push(new THREE.Vector3(-lastX / 100, -lastY / 100, lastZ / 100 +0.8));	        	geometry.vertices.push(new THREE.Vector3(-x / 100, -y / 100, z /100 + 0.8));	        	lastX = x;	        	lastY = y;	        	lastZ = z;	        	let line = new THREE.Line(geometry,material);	        	scene.add(line);	        	renderer.render(scene,camera);			}		} );		kinematicsTween.start();	}	//execute setupTween every duration	//setTimeout( setupTween, duration );	}function print() {	document.getElementById('dz').value = 0;	plan();	document.getElementById('dx').value += 1;	plan();}o"! v a r   c o n t a i n e r ,   s t a t s ; 
 
 v a r   c a m e r a ,   s c e n e ,   r e n d e r e r ,   o r b i t C o n t r o l ,   d e l t a ; 
 
 v a r   m o u s e X   =   0 ,   m o u s e Y   =   0 ; 
 
 v a r   w i n d o w H a l f X   =   w i n d o w . i n n e r W i d t h   /   2 ; 
 v a r   w i n d o w H a l f Y   =   w i n d o w . i n n e r H e i g h t   /   2 ; 
 
 v a r   t w e e n P a r a m e t e r s   =   { } ; 
 
 v a r   j o i n t V a l u e ; 
 v a r   j o i n t N u m   =   0 ; 
 v a r   t a r g e t   =   { } ; 
 
 v a r   b i g _ a r m   =   1 5 7 ; 
 v a r   s m a l l _ a r m   =   1 8 1 ; 
 v a r   c e n t e r _ o f f s e t   =   6 0 ; 
 v a r   h e a d _ o f f s e t   =   5 0 ; 
 
 v a r   l a s t X ,   l a s t Y ,   l a s t Z ; 
 
 v a r   l o a d e r   =   n e w   T H R E E . C o l l a d a L o a d e r ( ) ; 
 / /Sê‰j!W‹R }[ŒbÿVÞŒQýep\1Oˆ«Œu( 
 / /   l o a d e r . l o a d ( " m o d e l s / t e s t R o b o t . d a e " ,   f u n c t i o n ( c o l l a d a )   { 
 l o a d e r . l o a d ( " m o d e l s / r o b o t _ n . d a e " ,   f u n c t i o n ( c o l l a d a )   { 
 	 d a e   =   c o l l a d a . s c e n e ; 
 
 	 d a e . t r a v e r s e (   f u n c t i o n   (   c h i l d   )   { 
 
 	 	 i f   (   c h i l d   i n s t a n c e o f   T H R E E . M e s h   )   { 
 
 	 	 	 c h i l d . g e o m e t r y . c o m p u t e F a c e N o r m a l s ( ) ; 
 	 	 	 c h i l d . m a t e r i a l . s h a d i n g   =   T H R E E . F l a t S h a d i n g ; 
 
 	 	 } 
 
 	 }   ) ; 
 
 	 d a e . s c a l e . x   =   d a e . s c a l e . y   =   d a e . s c a l e . z   =   1 0 . 0 ; 
 	 d a e . u p d a t e M a t r i x ( ) ; 
 
 	 k i n e m a t i c s   =   c o l l a d a . k i n e m a t i c s ; 
 
 	 i n i t ( ) ; 
 
 	 a n i m a t e ( ) ; 
 } ) ; 
 
 f u n c t i o n   i n i t ( )   { 
 	 / / c o n t a i n e r   =   d o c u m e n t . c r e a t e E l e m e n t (   ' d i v '   ) ; 
 	 c o n t a i n e r   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' o u t p u t ' ) ; 
 	 d o c u m e n t . b o d y . a p p e n d C h i l d (   c o n t a i n e r   ) ; 
 
 	 c a m e r a   =   n e w   T H R E E . P e r s p e c t i v e C a m e r a ( 4 5 
 	 	 ,   w i n d o w . i n n e r W i d t h   /   w i n d o w . i n n e r H e i g h t 
 	 	 ,   1 ,   2 0 0 0 ) ; 
 	 c a m e r a . p o s i t i o n . x   =   2 ; 
 	 c a m e r a . p o s i t i o n . y   =   2 ; 
 	 c a m e r a . p o s i t i o n . z   =   1 0 ; 
 	 / / c a m e r a . l o o k A t ( n e w   T H R E E . V e c t o r 3 ( 1 0 ,   - 1 0 ,   - 1 0 ) ) ; 
 
 	 s c e n e   =   n e w   T H R E E . S c e n e ( ) ; 
 
 	 v a r   a m b i e n t   =   n e w   T H R E E . A m b i e n t L i g h t (   0 x 4 4 4 4 4 4   ) ; 
 	 s c e n e . a d d (   a m b i e n t   ) ; 
 
 	 s c e n e . a d d ( d a e ) ; 
 
 	 v a r   d i r e c t i o n a l L i g h t   =   n e w   T H R E E . D i r e c t i o n a l L i g h t (   0 x f f e e d d   ) ; 
 	 d i r e c t i o n a l L i g h t . p o s i t i o n . s e t (   0 ,   0 ,   1   ) . n o r m a l i z e ( ) ; 
 	 s c e n e . a d d (   d i r e c t i o n a l L i g h t   ) ; 
 
 	 r e n d e r e r   =   n e w   T H R E E . W e b G L R e n d e r e r ( ) ; 
 
 	 / / r e n d e r e r . s e t C l e a r C o l o r ( 0 x E E E E E E ) ; 
 	 r e n d e r e r . s e t P i x e l R a t i o (   w i n d o w . d e v i c e P i x e l R a t i o   ) ; 
 	 r e n d e r e r . s e t S i z e ( w i n d o w . i n n e r W i d t h   *   2   /   3 ,   w i n d o w . i n n e r H e i g h t ) ; 
 	 c o n t a i n e r . a p p e n d C h i l d (   r e n d e r e r . d o m E l e m e n t   ) ; 
 
 	 w i n d o w . a d d E v e n t L i s t e n e r (   ' r e s i z e ' ,   o n W i n d o w R e s i z e ,   f a l s e   ) ; 
 
 	 o r b i t C o n t r o l   =   n e w   T H R E E . O r b i t C o n t r o l s ( c a m e r a 
 	 	 ,   r e n d e r e r . d o m E l e m e n t ) ; 
 	 o r b i t C o n t r o l . a u t o R o t a t e   =   f a l s e ; 
 	 / /  êR¨eËleö”ŸvøQs   
 	 / /   v a r   c l o c k   =   n e w   T H R E E . C l o c k ( ) ; 
 	 / /   v a r   d e l t a   =   c l o c k . g e t D e l t a ( ) ; 
 
 	 s t a t s   =   n e w   S t a t s ( ) ; 
 	 c o n t a i n e r . a p p e n d C h i l d ( s t a t s . d o m ) ; 
 
 	 s e t u p T w e e n ( ) ; 
     
 } 
 
 f u n c t i o n   a n i m a t e ( )   { 
 	 r e q u e s t A n i m a t i o n F r a m e (   a n i m a t e   ) ; 	 
 	 r e n d e r ( ) ; 
 
 	 s t a t s . u p d a t e ( ) ; 
 	 T W E E N . u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   r e n d e r ( )   { 
 
 	 / /   c a m e r a . p o s i t i o n . x   + =   (   m o u s e X   -   c a m e r a . p o s i t i o n . x   )   *   . 0 5 ; 
 	 / /   c a m e r a . p o s i t i o n . y   + =   (   -   m o u s e Y   -   c a m e r a . p o s i t i o n . y   )   *   . 0 5 ; 
 
 	 c a m e r a . l o o k A t (   s c e n e . p o s i t i o n   ) ; 
 
 	 / / o r b i t C o n t r o l . u p d a t e ( d e l t a ) ; 
 
 	 r e n d e r e r . r e n d e r (   s c e n e ,   c a m e r a   ) ; 
 
 } 
 
 f u n c t i o n   s e t u p T w e e n ( )   { 
 
 	 / / v a r   d u r a t i o n   =   g e t R a n d o m I n t (   1 0 0 0 ,   5 0 0 0   ) ; 
 	 d u r a t i o n   =   1 0 0 0 ; 
 	 j o i n t N u m   =   0 ; 
 	 l a s t X   =   2 9 1 ; 
 	 l a s t Y   =   0 ; 
 	 l a s t Z   =   1 5 7 ; 
 
 	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   { 
 
 	 	 v a r   j o i n t   =   k i n e m a t i c s . j o i n t s [   i   ] ; 
 
 	 	 v a r   o l d   =   t w e e n P a r a m e t e r s [   i   ] ; 
 	 	 / /   c o n s o l e . l o g ( o l d ) ; 
 
 	 	 v a r   p o s i t i o n   =   o l d   ?   o l d   :   j o i n t . z e r o P o s i t i o n ; 
 
 	 	 t w e e n P a r a m e t e r s [   i   ]   =   p o s i t i o n ; 
 
 	 	 / /   t a r g e t [   i   ]   =   g e t R a n d o m I n t (   j o i n t . l i m i t s . m i n 
 	 	 / /   	 ,   j o i n t . l i m i t s . m a x   ) ; 
 	 	 t a r g e t [ i ]   =   0 ; 
 	 	 j o i n t N u m   + + ; 
 	 } 
 	 c o n s o l e . l o g ( j o i n t N u m ) ; 
 	 j o i n t V a l u e   =   n e w   A r r a y ( j o i n t N u m ) ; 
 
 	 / /   k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (   
 	 / /   	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (   
 	 / /   	 T W E E N . E a s i n g . Q u a d r a t i c . O u t   ) ; 
 	 k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (   
 	 	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (   
 	 	 T W E E N . E a s i n g . L i n e a r . N o n e   ) ; 
 
 	 k i n e m a t i c s T w e e n . o n U p d a t e (   f u n c t i o n ( )   { 
 
 	 	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   { 
 
 	 	 	 k i n e m a t i c s . s e t J o i n t V a l u e (   i ,   t h i s [   i   ]   ) ; 
 
 	 	 } 
 
 	 }   ) ; 
 
 	 k i n e m a t i c s T w e e n . s t a r t ( ) ; 
 
 	 / / e x e c u t e   s e t u p T w e e n   e v e r y   d u r a t i o n 
 	 / / s e t T i m e o u t (   s e t u p T w e e n ,   d u r a t i o n   ) ; 	 
 } 
 
 f u n c t i o n   g e t R a n d o m I n t (   m i n ,   m a x   )   { 
 
 	 r e t u r n   M a t h . f l o o r (   M a t h . r a n d o m ( )   *   (   m a x   -   m i n   +   1   )   )   +   m i n ; 
 
 } 
 
 f u n c t i o n   o n W i n d o w R e s i z e ( )   { 
 
 	 w i n d o w H a l f X   =   w i n d o w . i n n e r W i d t h   /   2 ; 
 	 w i n d o w H a l f Y   =   w i n d o w . i n n e r H e i g h t   /   2 ; 
 
 	 c a m e r a . a s p e c t   =   w i n d o w . i n n e r W i d t h   /   w i n d o w . i n n e r H e i g h t ; 
 	 c a m e r a . u p d a t e P r o j e c t i o n M a t r i x ( ) ; 
 
 	 r e n d e r e r . s e t S i z e (   w i n d o w . i n n e r W i d t h   *   2   /   3 ,   w i n d o w . i n n e r H e i g h t   ) ; 
 
 } 
 
 f u n c t i o n   s u b m i t ( )   { 
 	 j o i n t V a l u e   =   n e w   A r r a y ( j o i n t N u m ) ; 
 	 / / j o i n t 1   &   4   &   5   &   9   :   m a i n   j o i n t 
 	 j o i n t V a l u e [ 0 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 1 ' ) . v a l u e ; 	 / / j o i n t 1 ,   b a s e 
 	 j o i n t V a l u e [ 1 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e ; 	 / / j o i n t 2 
 	 j o i n t V a l u e [ 2 ]   =   0 ; 	 / / j o i n t 3 
 	 j o i n t V a l u e [ 3 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e ; 	 / / j o i n t 4 ,   b i g   a r m 
 	 j o i n t V a l u e [ 4 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 5 ' ) . v a l u e ; 	 / / j o i n t 5 ,   s m a l l   a r m 
 	 j o i n t V a l u e [ 5 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 5 ' ) . v a l u e ; 	 / / j o i n t 6 
 	 j o i n t V a l u e [ 6 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e ; 	 / / j o i n t 7 
 	 j o i n t V a l u e [ 7 ]   =   0 ; 	 / / j o i n t 8 
 	 j o i n t V a l u e [ 8 ]   =   -   j o i n t V a l u e [ 3 ]   -   j o i n t V a l u e [ 4 ] ; 	 / / j o i n t 9 ,   h e a d 
 
 	 u p d a t e T w e e n ( ) ; 
 } 
 
 f u n c t i o n   p l a n ( )   { 
 	 v a r   t o D e g   =   3 6 0   /   ( 2   *   M a t h . P I ) ; 
 
 	 v a r   a n g l e _ b a s e   =   j o i n t V a l u e [ 0 ] ; 
 	 v a r   a n g l e _ b i g   =   j o i n t V a l u e [ 3 ] ; 
 	 v a r   a n g l e _ s m a l l   =   j o i n t V a l u e [ 4 ] ; 
 
 	 / /kc‰ãÇz0Q™•N†ÿ^”‹åu(_'^¦R6NãQeN	‰ÒQýep0 
 	 / /   v a r   x   =   ( M a t h . s i n ( - a n g l e _ b i g )   *   b i g _ a r m   -   ( 1   -   M a t h . c o s ( a n g l e _ s m a l l ) )   *   s m a l l _ a r m )   *   M a t h . c o s ( a n g l e _ b a s e )   +   c e n t e r _ o f f s e t   +   h e a d _ o f f s e t ; 
 	 / /   v a r   y   =   x   *   t a n ( a n g l e _ b a s e ) ; 
 	 / /   v a r   z   =   M a t h . s i n ( a n g l e _ s m a l l )   *   s m a l l _ a r m   -   ( 1   -   M a t h . c o s ( a n g l e _ b i g ) )   *   b i g _ a r m ; 
 
 	 v a r   d e s _ x   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' d x ' ) . v a l u e ; 
 	 v a r   d e s _ y   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' d y ' ) . v a l u e ; 
 	 v a r   d e s _ z   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' d z ' ) . v a l u e ; 
 
 	 v a r   a r m _ x y   =   M a t h . s q r t ( M a t h . p o w ( d e s _ x ,   2 )   +   M a t h . p o w ( d e s _ y ,   2 ) )   -   c e n t e r _ o f f s e t   -   h e a d _ o f f s e t ; 
 	 v a r   a r m _ x y z   =   M a t h . s q r t ( M a t h . p o w ( a r m _ x y ,   2 )   +   M a t h . p o w ( d e s _ z ,   2 ) ) ; 
 	 v a r   d e l t a _ a r m s   =   M a t h . a c o s ( ( M a t h . p o w ( s m a l l _ a r m ,   2 )   +   M a t h . p o w ( b i g _ a r m ,   2 )   -   M a t h . p o w ( a r m _ x y z ,   2 ) )   /   ( 2   *   s m a l l _ a r m   *   b i g _ a r m ) ) ;   / /Y'Â\Â•ôY9‰Òÿ_'^¦R6 
 	 v a r   d e l t a _ b i g _ a r m   =   M a t h . a c o s ( ( M a t h . p o w ( a r m _ x y z ,   2 )   +   M a t h . p o w ( b i g _ a r m ,   2 )   -   M a t h . p o w ( s m a l l _ a r m ,   2 ) )   /   ( 2   *   a r m _ x y z   *   b i g _ a r m ) ) 
 	 	 	 +   M a t h . a c o s ( ( M a t h . p o w ( a r m _ x y z ,   2 )   +   M a t h . p o w ( a r m _ x y ,   2 )   -   M a t h . p o w ( d e s _ z ,   2 ) )   /   ( 2   *   a r m _ x y z   *   a r m _ x y ) ) ; 
 	 v a r   d e l t a _ r o t a t i o n   =   M a t h . a t a n ( d e s _ y   /   d e s _ x ) ; 
 
 	 / / j o i n t V a l u e   =   n e w   A r r a y ( j o i n t N u m ) ; 
 	 / / j o i n t 1   &   4   &   5   &   9   :   m a i n   j o i n t 
 	 j o i n t V a l u e [ 0 ]   =   d e l t a _ r o t a t i o n   *   t o D e g ; 	 / / j o i n t 1 ,   b a s e 
 	 j o i n t V a l u e [ 1 ]   =   d e l t a _ b i g _ a r m   *   t o D e g   -   9 0 ; 	 / / j o i n t 2 
 	 j o i n t V a l u e [ 2 ]   =   0 ; 	 / / j o i n t 3 
 	 j o i n t V a l u e [ 3 ]   =   j o i n t V a l u e [ 1 ] ; 	 / / j o i n t 4 ,   b i g   a r m 
 	 / / j o i n t V a l u e [ 4 ]   =   ( d e l t a _ a r m s   +   d e l t a _ b i g _ a r m )   *   t o D e g   -   1 8 0 ; 	 / / j o i n t 5 ,   s m a l l   a r m 
 	 j o i n t V a l u e [ 4 ]   =   d e l t a _ a r m s   *   t o D e g   -   9 0 ; 	 / / j o i n t 5 ,   s m a l l   a r m 
 	 j o i n t V a l u e [ 5 ]   =   j o i n t V a l u e [ 4 ] ; 	 / / j o i n t 6 
 	 j o i n t V a l u e [ 6 ]   =   j o i n t V a l u e [ 1 ] ; 	 / / j o i n t 7 
 	 j o i n t V a l u e [ 7 ]   =   0 ; 	 / / j o i n t 8 
 	 j o i n t V a l u e [ 8 ]   =   -   j o i n t V a l u e [ 3 ]   -   j o i n t V a l u e [ 4 ] ; 	 / / j o i n t 9 ,   h e a d 
 
 	 u p d a t e T w e e n ( ) ; 
 
 } 
 
 f u n c t i o n   u p d a t e T w e e n ( )   { 
 
 	 d u r a t i o n   =   2 0 0 ; 
 
 	 l e t   t i m e s   =   5 ; 
 
 	 f o r   ( v a r   j   =   0 ;   j   <   t i m e s ;   j   + + )   { 
 
 	 	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   { 
 
 	 	 	 v a r   j o i n t   =   k i n e m a t i c s . j o i n t s [   i   ] ; 
 
 	 	 	 v a r   o l d   =   t w e e n P a r a m e t e r s [   i   ] ; 
 	 	 	 / /   c o n s o l e . l o g ( o l d ) ; 
 
 	 	 	 v a r   p o s i t i o n   =   o l d   ?   o l d   :   j o i n t . z e r o P o s i t i o n ; 
 
 	 	 	 t w e e n P a r a m e t e r s [   i   ]   =   p o s i t i o n ; 
 
 	 	 	 / /   t a r g e t [   i   ]   =   g e t R a n d o m I n t (   j o i n t . l i m i t s . m i n 
 	 	 	 / /   	 ,   j o i n t . l i m i t s . m a x   ) ; 
 	 	 	 t a r g e t [ i ]   =   j o i n t V a l u e [ i ]   /   t i m e s   *   ( j   +   1 ) ; 
 
 	 	 	 / / c o n s o l e . l o g ( t a r g e t [ i ] ) ; 
 
 	 	 } 
 
 	 	 / /   k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (   
 	 	 / /   	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (   
 	 	 / /   	 T W E E N . E a s i n g . Q u a d r a t i c . O u t   ) ; 
 	 	 k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (   
 	 	 	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (   
 	 	 	 T W E E N . E a s i n g . L i n e a r . N o n e   ) ; 
 
 	 	 k i n e m a t i c s T w e e n . o n U p d a t e (   f u n c t i o n ( )   { 
 
 	 	 	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   { 
 
 	 	 	 	 / /‰Ò^¦P<ÿ—^_'^¦ 
 	 	 	 	 l e t   b a s e   =   t h i s [ 0 ] ; 
 	 	 	 	 l e t   b a r m   =   t h i s [ 3 ] ; 
 	 	 	 	 l e t   a r m s   =   t h i s [ 4 ]   +   9 0 ; 
 	 	 	 	 / / l e t   h e a d   =   t h i s [ 8 ] ; 	 
 	 	 	 	 l e t   t o R a d   =   2   *   M a t h . P I   /   3 6 0 ; 
 
 	 	 	 	 k i n e m a t i c s . s e t J o i n t V a l u e (   i ,   t h i s [   i   ]   ) ; 
 
 	 	 	 	 l e t   x   =   ( s m a l l _ a r m   *   M a t h . c o s ( t o R a d   *   ( a r m s   -   9 0   + b a r m ) ) 
 	 	 	 	 	   -   b i g _ a r m   *   M a t h . s i n ( t o R a d   *   b a r m )   +   h e a d _ o f f s e t   +   c e n t e r _ o f f s e t ) 
 	 	 	 	 	   *   M a t h . c o s ( t o R a d   *   b a s e ) ; 
 	 	 	 	 l e t   y   =   x   *   M a t h . t a n ( t o R a d   *   b a s e ) ; 
 	 	 	 	 l e t   z   =   s m a l l _ a r m   *   M a t h . s i n ( t o R a d   *   ( a r m s   -   9 0   + b a r m ) ) 
 	 	 	 	 	   +   b i g _ a r m   *   M a t h . c o s ( t o R a d   *   b a r m ) ; 
 
 	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' s x ' ) . v a l u e   =   x ; 
 	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' s y ' ) . v a l u e   =   y ; 
 	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' s z ' ) . v a l u e   =   z ; 
 	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' j 1 ' ) . v a l u e   =   b a s e ; 
 	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e   =   b a r m ; 
 	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' j 5 ' ) . v a l u e   =   a r m s   -   9 0 ; 	 	 	 
 
 	 	 	 	 l e t   m a t e r i a l   =   n e w   T H R E E . L i n e B a s i c M a t e r i a l ( { c o l o r : 0 x F F 0 0 0 0 } ) ; 
 	 	 	 	 l e t   g e o m e t r y   =   n e w   T H R E E . G e o m e t r y ( ) ; 
 	 	 	 	 g e o m e t r y . v e r t i c e s . p u s h ( n e w   T H R E E . V e c t o r 3 ( - l a s t X   /   1 0 0 ,   - l a s t Y   /   1 0 0 ,   l a s t Z   /   1 0 0   + 0 . 8 ) ) ; 
 	                 	 g e o m e t r y . v e r t i c e s . p u s h ( n e w   T H R E E . V e c t o r 3 ( - x   /   1 0 0 ,   - y   /   1 0 0 ,   z   / 1 0 0   +   0 . 8 ) ) ; 
 	                 	 l a s t X   =   x ; 
 	                 	 l a s t Y   =   y ; 
 	                 	 l a s t Z   =   z ; 
 	                 	 l e t   l i n e   =   n e w   T H R E E . L i n e ( g e o m e t r y , m a t e r i a l ) ; 
 	                 	 s c e n e . a d d ( l i n e ) ; 
 	                 	 r e n d e r e r . r e n d e r ( s c e n e , c a m e r a ) ; 
 	 	 	 } 
 
 	 	 }   ) ; 
 
 	 	 k i n e m a t i c s T w e e n . s t a r t ( ) ; 
 	 } 
 
 	 / / e x e c u t e   s e t u p T w e e n   e v e r y   d u r a t i o n 
 	 / / s e t T i m e o u t (   s e t u p T w e e n ,   d u r a t i o n   ) ; 	 
 } 
 
 
 
 
 f u n c t i o n   p r i n t ( )   { 
 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' d z ' ) . v a l u e   =   0 ; 
 	 p l a n ( ) ; 
 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' d x ' ) . v a l u e   + =   1 ; 
 	 p l a n ( ) ; 
 }ODBv a r   c o n t a i n e r ,   s t a t s ;   v a r   c a m e r a ,   s c e n e ,   r e n d e r e r ,   o r b i t C o n t r o l ,   d e l t a ;   v a r   m o u s e X   =   0 ,   m o u s e Y   =   0 ;   v a r   w i n d o w H a l f X   =   w i n d o w . i n n e r W i d t h   /   2 ;  v a r   w i n d o w H a l f Y   =   w i n d o w . i n n e r H e i g h t   /   2 ;   v a r   t w e e n P a r a m e t e r s   =   { } ;   v a r   j o i n t V a l u e ;  v a r   j o i n t N u m   =   0 ;  v a r   t a r g e t   =   { } ;   v a r   b i g _ a r m   =   1 5 7 ;  v a r   s m a l l _ a r m   =   1 8 1 ;  v a r   c e n t e r _ o f f s e t   =   6 0 ;  v a r   h e a d _ o f f s e t   =   5 0 ;   v a r   l a s t X ,   l a s t Y ,   l a s t Z ;   v a r   l o a d e r   =   n e w   T H R E E . C o l l a d a L o a d e r ( ) ;  / / êS‰!j‹W R}Œ[bÿÞVŒýQpe1\O«ˆŒ(u / /   l o a d e r . l o a d ( " m o d e l s / t e s t R o b o t . d a e " ,   f u n c t i o n ( c o l l a d a )   {  l o a d e r . l o a d ( " m o d e l s / r o b o t _ n . d a e " ,   f u n c t i o n ( c o l l a d a )   {  	 d a e   =   c o l l a d a . s c e n e ;   	 d a e . t r a v e r s e (   f u n c t i o n   (   c h i l d   )   {   	 	 i f   (   c h i l d   i n s t a n c e o f   T H R E E . M e s h   )   {   	 	 	 c h i l d . g e o m e t r y . c o m p u t e F a c e N o r m a l s ( ) ;  	 	 	 c h i l d . m a t e r i a l . s h a d i n g   =   T H R E E . F l a t S h a d i n g ;   	 	 }   	 }   ) ;   	 d a e . s c a l e . x   =   d a e . s c a l e . y   =   d a e . s c a l e . z   =   1 0 . 0 ;  	 d a e . u p d a t e M a t r i x ( ) ;   	 k i n e m a t i c s   =   c o l l a d a . k i n e m a t i c s ;   	 i n i t ( ) ;   	 a n i m a t e ( ) ;  } ) ;   f u n c t i o n   i n i t ( )   {  	 / / c o n t a i n e r   =   d o c u m e n t . c r e a t e E l e m e n t (   ' d i v '   ) ;  	 c o n t a i n e r   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' o u t p u t ' ) ;  	 d o c u m e n t . b o d y . a p p e n d C h i l d (   c o n t a i n e r   ) ;   	 c a m e r a   =   n e w   T H R E E . P e r s p e c t i v e C a m e r a ( 4 5  	 	 ,   w i n d o w . i n n e r W i d t h   /   w i n d o w . i n n e r H e i g h t  	 	 ,   1 ,   2 0 0 0 ) ;  	 c a m e r a . p o s i t i o n . x   =   2 ;  	 c a m e r a . p o s i t i o n . y   =   2 ;  	 c a m e r a . p o s i t i o n . z   =   1 0 ;  	 / / c a m e r a . l o o k A t ( n e w   T H R E E . V e c t o r 3 ( 1 0 ,   - 1 0 ,   - 1 0 ) ) ;   	 s c e n e   =   n e w   T H R E E . S c e n e ( ) ;   	 v a r   a m b i e n t   =   n e w   T H R E E . A m b i e n t L i g h t (   0 x 4 4 4 4 4 4   ) ;  	 s c e n e . a d d (   a m b i e n t   ) ;   	 s c e n e . a d d ( d a e ) ;   	 v a r   d i r e c t i o n a l L i g h t   =   n e w   T H R E E . D i r e c t i o n a l L i g h t (   0 x f f e e d d   ) ;  	 d i r e c t i o n a l L i g h t . p o s i t i o n . s e t (   0 ,   0 ,   1   ) . n o r m a l i z e ( ) ;  	 s c e n e . a d d (   d i r e c t i o n a l L i g h t   ) ;   	 r e n d e r e r   =   n e w   T H R E E . W e b G L R e n d e r e r ( ) ;   	 / / r e n d e r e r . s e t C l e a r C o l o r ( 0 x E E E E E E ) ;  	 r e n d e r e r . s e t P i x e l R a t i o (   w i n d o w . d e v i c e P i x e l R a t i o   ) ;  	 r e n d e r e r . s e t S i z e ( w i n d o w . i n n e r W i d t h   *   2   /   3 ,   w i n d o w . i n n e r H e i g h t ) ;  	 c o n t a i n e r . a p p e n d C h i l d (   r e n d e r e r . d o m E l e m e n t   ) ;   	 w i n d o w . a d d E v e n t L i s t e n e r (   ' r e s i z e ' ,   o n W i n d o w R e s i z e ,   f a l s e   ) ;   	 o r b i t C o n t r o l   =   n e w   T H R E E . O r b i t C o n t r o l s ( c a m e r a  	 	 ,   r e n d e r e r . d o m E l e m e n t ) ;  	 o r b i t C o n t r o l . a u t o R o t a t e   =   f a l s e ;  	 / /   ê¨RËelöeŸ”øvsQ   	 / /   v a r   c l o c k   =   n e w   T H R E E . C l o c k ( ) ;  	 / /   v a r   d e l t a   =   c l o c k . g e t D e l t a ( ) ;   	 s t a t s   =   n e w   S t a t s ( ) ;  	 c o n t a i n e r . a p p e n d C h i l d ( s t a t s . d o m ) ;   	 s e t u p T w e e n ( ) ;       }   f u n c t i o n   a n i m a t e ( )   {  	 r e q u e s t A n i m a t i o n F r a m e (   a n i m a t e   ) ; 	  	 r e n d e r ( ) ;   	 s t a t s . u p d a t e ( ) ;  	 T W E E N . u p d a t e ( ) ;  }   f u n c t i o n   r e n d e r ( )   {   	 / /   c a m e r a . p o s i t i o n . x   + =   (   m o u s e X   -   c a m e r a . p o s i t i o n . x   )   *   . 0 5 ;  	 / /   c a m e r a . p o s i t i o n . y   + =   (   -   m o u s e Y   -   c a m e r a . p o s i t i o n . y   )   *   . 0 5 ;   	 c a m e r a . l o o k A t (   s c e n e . p o s i t i o n   ) ;   	 / / o r b i t C o n t r o l . u p d a t e ( d e l t a ) ;   	 r e n d e r e r . r e n d e r (   s c e n e ,   c a m e r a   ) ;   }   f u n c t i o n   s e t u p T w e e n ( )   {   	 / / v a r   d u r a t i o n   =   g e t R a n d o m I n t (   1 0 0 0 ,   5 0 0 0   ) ;  	 d u r a t i o n   =   1 0 0 0 ;  	 j o i n t N u m   =   0 ;  	 l a s t X   =   2 9 1 ;  	 l a s t Y   =   0 ;  	 l a s t Z   =   1 5 7 ;   	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   {   	 	 v a r   j o i n t   =   k i n e m a t i c s . j o i n t s [   i   ] ;   	 	 v a r   o l d   =   t w e e n P a r a m e t e r s [   i   ] ;  	 	 / /   c o n s o l e . l o g ( o l d ) ;   	 	 v a r   p o s i t i o n   =   o l d   ?   o l d   :   j o i n t . z e r o P o s i t i o n ;   	 	 t w e e n P a r a m e t e r s [   i   ]   =   p o s i t i o n ;   	 	 / /   t a r g e t [   i   ]   =   g e t R a n d o m I n t (   j o i n t . l i m i t s . m i n  	 	 / /   	 ,   j o i n t . l i m i t s . m a x   ) ;  	 	 t a r g e t [ i ]   =   0 ;  	 	 j o i n t N u m   + + ;  	 }  	 c o n s o l e . l o g ( j o i n t N u m ) ;  	 j o i n t V a l u e   =   n e w   A r r a y ( j o i n t N u m ) ;   	 / /   k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (    	 / /   	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (    	 / /   	 T W E E N . E a s i n g . Q u a d r a t i c . O u t   ) ;  	 k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (    	 	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (    	 	 T W E E N . E a s i n g . L i n e a r . N o n e   ) ;   	 k i n e m a t i c s T w e e n . o n U p d a t e (   f u n c t i o n ( )   {   	 	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   {   	 	 	 k i n e m a t i c s . s e t J o i n t V a l u e (   i ,   t h i s [   i   ]   ) ;   	 	 }   	 }   ) ;   	 k i n e m a t i c s T w e e n . s t a r t ( ) ;   	 / / e x e c u t e   s e t u p T w e e n   e v e r y   d u r a t i o n  	 / / s e t T i m e o u t (   s e t u p T w e e n ,   d u r a t i o n   ) ; 	  }   f u n c t i o n   g e t R a n d o m I n t (   m i n ,   m a x   )   {   	 r e t u r n   M a t h . f l o o r (   M a t h . r a n d o m ( )   *   (   m a x   -   m i n   +   1   )   )   +   m i n ;   }   f u n c t i o n   o n W i n d o w R e s i z e ( )   {   	 w i n d o w H a l f X   =   w i n d o w . i n n e r W i d t h   /   2 ;  	 w i n d o w H a l f Y   =   w i n d o w . i n n e r H e i g h t   /   2 ;   	 c a m e r a . a s p e c t   =   w i n d o w . i n n e r W i d t h   /   w i n d o w . i n n e r H e i g h t ;  	 c a m e r a . u p d a t e P r o j e c t i o n M a t r i x ( ) ;   	 r e n d e r e r . s e t S i z e (   w i n d o w . i n n e r W i d t h   *   2   /   3 ,   w i n d o w . i n n e r H e i g h t   ) ;   }   f u n c t i o n   s u b m i t ( )   {  	 j o i n t V a l u e   =   n e w   A r r a y ( j o i n t N u m ) ;  	 / / j o i n t 1   &   4   &   5   &   9   :   m a i n   j o i n t  	 j o i n t V a l u e [ 0 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 1 ' ) . v a l u e ; 	 / / j o i n t 1 ,   b a s e  	 j o i n t V a l u e [ 1 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e ; 	 / / j o i n t 2  	 j o i n t V a l u e [ 2 ]   =   0 ; 	 / / j o i n t 3  	 j o i n t V a l u e [ 3 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e ; 	 / / j o i n t 4 ,   b i g   a r m  	 j o i n t V a l u e [ 4 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 5 ' ) . v a l u e ; 	 / / j o i n t 5 ,   s m a l l   a r m  	 j o i n t V a l u e [ 5 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 5 ' ) . v a l u e ; 	 / / j o i n t 6  	 j o i n t V a l u e [ 6 ]   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e ; 	 / / j o i n t 7  	 j o i n t V a l u e [ 7 ]   =   0 ; 	 / / j o i n t 8  	 j o i n t V a l u e [ 8 ]   =   -   j o i n t V a l u e [ 3 ]   -   j o i n t V a l u e [ 4 ] ; 	 / / j o i n t 9 ,   h e a d   	 u p d a t e T w e e n ( ) ;  }   f u n c t i o n   p l a n ( )   {  	 v a r   t o D e g   =   3 6 0   /   ( 2   *   M a t h . P I ) ;   	 v a r   a n g l e _ b a s e   =   j o i n t V a l u e [ 0 ] ;  	 v a r   a n g l e _ b i g   =   j o i n t V a l u e [ 3 ] ;  	 v a r   a n g l e _ s m a l l   =   j o i n t V a l u e [ 4 ] ;   	 / / ckã‰Çz0™Q•†Nÿ”^å‹(u'_¦^6RãNeQ	NÒ‰ýQpe0 	 / /   v a r   x   =   ( M a t h . s i n ( - a n g l e _ b i g )   *   b i g _ a r m   -   ( 1   -   M a t h . c o s ( a n g l e _ s m a l l ) )   *   s m a l l _ a r m )   *   M a t h . c o s ( a n g l e _ b a s e )   +   c e n t e r _ o f f s e t   +   h e a d _ o f f s e t ;  	 / /   v a r   y   =   x   *   t a n ( a n g l e _ b a s e ) ;  	 / /   v a r   z   =   M a t h . s i n ( a n g l e _ s m a l l )   *   s m a l l _ a r m   -   ( 1   -   M a t h . c o s ( a n g l e _ b i g ) )   *   b i g _ a r m ;   	 v a r   d e s _ x   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' d x ' ) . v a l u e ;  	 v a r   d e s _ y   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' d y ' ) . v a l u e ;  	 v a r   d e s _ z   =   d o c u m e n t . g e t E l e m e n t B y I d ( ' d z ' ) . v a l u e ;   	 v a r   a r m _ x y   =   M a t h . s q r t ( M a t h . p o w ( d e s _ x ,   2 )   +   M a t h . p o w ( d e s _ y ,   2 ) )   -   c e n t e r _ o f f s e t   -   h e a d _ o f f s e t ;  	 v a r   a r m _ x y z   =   M a t h . s q r t ( M a t h . p o w ( a r m _ x y ,   2 )   +   M a t h . p o w ( d e s _ z ,   2 ) ) ;  	 v a r   d e l t a _ a r m s   =   M a t h . a c o s ( ( M a t h . p o w ( s m a l l _ a r m ,   2 )   +   M a t h . p o w ( b i g _ a r m ,   2 )   -   M a t h . p o w ( a r m _ x y z ,   2 ) )   /   ( 2   *   s m a l l _ a r m   *   b i g _ a r m ) ) ;   / / 'YÂ\Âô•9YÒ‰ÿ'_¦^6R 	 v a r   d e l t a _ b i g _ a r m   =   M a t h . a c o s ( ( M a t h . p o w ( a r m _ x y z ,   2 )   +   M a t h . p o w ( b i g _ a r m ,   2 )   -   M a t h . p o w ( s m a l l _ a r m ,   2 ) )   /   ( 2   *   a r m _ x y z   *   b i g _ a r m ) )  	 	 	 +   M a t h . a c o s ( ( M a t h . p o w ( a r m _ x y z ,   2 )   +   M a t h . p o w ( a r m _ x y ,   2 )   -   M a t h . p o w ( d e s _ z ,   2 ) )   /   ( 2   *   a r m _ x y z   *   a r m _ x y ) ) ;  	 v a r   d e l t a _ r o t a t i o n   =   M a t h . a t a n ( d e s _ y   /   d e s _ x ) ;   	 / / j o i n t V a l u e   =   n e w   A r r a y ( j o i n t N u m ) ;  	 / / j o i n t 1   &   4   &   5   &   9   :   m a i n   j o i n t  	 j o i n t V a l u e [ 0 ]   =   d e l t a _ r o t a t i o n   *   t o D e g ; 	 / / j o i n t 1 ,   b a s e  	 j o i n t V a l u e [ 1 ]   =   d e l t a _ b i g _ a r m   *   t o D e g   -   9 0 ; 	 / / j o i n t 2  	 j o i n t V a l u e [ 2 ]   =   0 ; 	 / / j o i n t 3  	 j o i n t V a l u e [ 3 ]   =   j o i n t V a l u e [ 1 ] ; 	 / / j o i n t 4 ,   b i g   a r m  	 / / j o i n t V a l u e [ 4 ]   =   ( d e l t a _ a r m s   +   d e l t a _ b i g _ a r m )   *   t o D e g   -   1 8 0 ; 	 / / j o i n t 5 ,   s m a l l   a r m  	 j o i n t V a l u e [ 4 ]   =   d e l t a _ a r m s   *   t o D e g   -   9 0 ; 	 / / j o i n t 5 ,   s m a l l   a r m  	 j o i n t V a l u e [ 5 ]   =   j o i n t V a l u e [ 4 ] ; 	 / / j o i n t 6  	 j o i n t V a l u e [ 6 ]   =   j o i n t V a l u e [ 1 ] ; 	 / / j o i n t 7  	 j o i n t V a l u e [ 7 ]   =   0 ; 	 / / j o i n t 8  	 j o i n t V a l u e [ 8 ]   =   -   j o i n t V a l u e [ 3 ]   -   j o i n t V a l u e [ 4 ] ; 	 / / j o i n t 9 ,   h e a d   	 u p d a t e T w e e n ( ) ;   }   f u n c t i o n   u p d a t e T w e e n ( )   {   	 d u r a t i o n   =   2 0 0 ;   	 l e t   t i m e s   =   5 ;   	 f o r   ( v a r   j   =   0 ;   j   <   t i m e s ;   j   + + )   {   	 	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   {   	 	 	 v a r   j o i n t   =   k i n e m a t i c s . j o i n t s [   i   ] ;   	 	 	 v a r   o l d   =   t w e e n P a r a m e t e r s [   i   ] ;  	 	 	 / /   c o n s o l e . l o g ( o l d ) ;   	 	 	 v a r   p o s i t i o n   =   o l d   ?   o l d   :   j o i n t . z e r o P o s i t i o n ;   	 	 	 t w e e n P a r a m e t e r s [   i   ]   =   p o s i t i o n ;   	 	 	 / /   t a r g e t [   i   ]   =   g e t R a n d o m I n t (   j o i n t . l i m i t s . m i n  	 	 	 / /   	 ,   j o i n t . l i m i t s . m a x   ) ;  	 	 	 t a r g e t [ i ]   =   j o i n t V a l u e [ i ]   /   t i m e s   *   ( j   +   1 ) ;   	 	 	 / / c o n s o l e . l o g ( t a r g e t [ i ] ) ;   	 	 }   	 	 / /   k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (    	 	 / /   	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (    	 	 / /   	 T W E E N . E a s i n g . Q u a d r a t i c . O u t   ) ;  	 	 k i n e m a t i c s T w e e n   =   n e w   T W E E N . T w e e n (    	 	 	 t w e e n P a r a m e t e r s   ) . t o (   t a r g e t ,   d u r a t i o n   ) . e a s i n g (    	 	 	 T W E E N . E a s i n g . L i n e a r . N o n e   ) ;   	 	 k i n e m a t i c s T w e e n . o n U p d a t e (   f u n c t i o n ( )   {   	 	 	 f o r   (   v a r   i   =   0 ;   i   <   k i n e m a t i c s . j o i n t s . l e n g t h ;   i   + +   )   {   	 	 	 	 / / Ò‰¦^<Pÿ^—'_¦^ 	 	 	 	 l e t   b a s e   =   t h i s [ 0 ] ;  	 	 	 	 l e t   b a r m   =   t h i s [ 3 ] ;  	 	 	 	 l e t   a r m s   =   t h i s [ 4 ]   +   9 0 ;  	 	 	 	 / / l e t   h e a d   =   t h i s [ 8 ] ; 	  	 	 	 	 l e t   t o R a d   =   2   *   M a t h . P I   /   3 6 0 ;   	 	 	 	 k i n e m a t i c s . s e t J o i n t V a l u e (   i ,   t h i s [   i   ]   ) ;   	 	 	 	 l e t   x   =   ( s m a l l _ a r m   *   M a t h . c o s ( t o R a d   *   ( a r m s   -   9 0   + b a r m ) )  	 	 	 	 	   -   b i g _ a r m   *   M a t h . s i n ( t o R a d   *   b a r m )   +   h e a d _ o f f s e t   +   c e n t e r _ o f f s e t )  	 	 	 	 	   *   M a t h . c o s ( t o R a d   *   b a s e ) ;  	 	 	 	 l e t   y   =   x   *   M a t h . t a n ( t o R a d   *   b a s e ) ;  	 	 	 	 l e t   z   =   s m a l l _ a r m   *   M a t h . s i n ( t o R a d   *   ( a r m s   -   9 0   + b a r m ) )  	 	 	 	 	   +   b i g _ a r m   *   M a t h . c o s ( t o R a d   *   b a r m ) ;   	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' s x ' ) . v a l u e   =   x ;  	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' s y ' ) . v a l u e   =   y ;  	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' s z ' ) . v a l u e   =   z ;  	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' j 1 ' ) . v a l u e   =   b a s e ;  	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' j 4 ' ) . v a l u e   =   b a r m ;  	 	 	 	 d o c u m e n t . g e t E l e m e n t B y I d ( ' j 5 ' ) . v a l u e   =   a r m s   -   9 0 ; 	 	 	   	 	 	 	 l e t   m a t e r i a l   =   n e w   T H R E E . L i n e B a s i c M a t e r i a l ( { c o l o r : 0 x F F 0 0 0 0 } ) ;  	 	 	 	 l e t   g e o m e t r y   =   n e w   T H R E E . G e o m e t r y ( ) ;  	 	 	 	 g e o m e t r y . v e r t i c e s . p u s h ( n e w   T H R E E . V e c t o r 3 ( - l a s t X   /   1 0 0 ,   - l a s t Y   /   1 0 0 ,   l a s t Z   /   1 0 0   + 0 . 8 ) ) ;  	                 	 g e o m e t r y . v e r t i c e s . p u s h ( n e w   T H R E E . V e c t o r 3 ( - x   /   1 0 0 ,   - y   /   1 0 0 ,   z   / 1 0 0   +   0 . 8 ) ) ;  	                 	 l a s t X   =   x ;  	                 	 l a s t Y   =   y ;  	                 	 l a s t Z   =   z ;  	                 	 l e t   l i n e   =   n e w   T H R E E . L i n e ( g e o m e t r y , m a t e r i a l ) ;  	                 	 s c e n e . a d d ( l i n e ) ;  	                 	 r e n d e r e r . r e n d e r ( s c e n e , c a m e r a ) ;  	 	 	 }   	 	 }   ) ;   	 	 k i n e m a t i c s T w e e n . s t a r t ( ) ;  	 }   	 / / e x e c u t e   s e t u p T w e e n   e v e r y   d u r a t i o n  	 / / s e t T i m e o u t (   s e t u p T w e e n ,   d u r a t i o n   ) ; 	  }      f u n c t i o n   p r i n t ( )   {  	 d o c u m e n t . g e t E l e m e n t B y I d ( ' d z ' ) . v a l u e   =   0 ;  	 p l a n ( ) ;  	 d o c u m e n t . g e t E l e m e n t B y I d ( ' d x ' ) . v a l u e   + =   1 ;  	 p l a n ( ) ;  }      B [ u"Üg"             	              «h